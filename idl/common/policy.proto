syntax = "proto3";

package flyteidl.common;

import "common/authorization.proto";
import "common/identifier.proto";
import "validate/validate.proto";

option go_package = "github.com/flyteorg/flyte/v2/gen/go/common";

// A policy is a collection of roles bound to a resource.
message Policy {
  PolicyIdentifier id = 1 [(validate.rules).message.required = true];

  repeated PolicyBinding bindings = 2;

  // Optional: human readable description
  string description = 3;
}

// A policy binding represents a role (a set of actions) defined on a resource.
message PolicyBinding {
  // The role designates the permitted set of actions which can be applied to the resource.
  RoleIdentifier role_id = 1 [(validate.rules).message.required = true];

  common.Resource resource = 2 [(validate.rules).message.required = true];
}
